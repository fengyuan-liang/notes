# å¤šçº¿ç¨‹å­¦ä¹ äºŒï¼Œçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ä¸­æ–­



## 1. Javaçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ

æ€ç»´å¯¼å›¾ï¼š

![image-20220121111254673](https://cdn.fengxianhub.top/resources-master/202201211112781.png)







ç¤ºæ„å›¾ï¼š

![image-20220121111226777](https://cdn.fengxianhub.top/resources-master/202201211112900.png)



## 2. çº¿ç¨‹ä¸­æ–­

æ€ç»´å¯¼å›¾ï¼š

![image-20220121111534892](https://cdn.fengxianhub.top/resources-master/202201211115989.png)



åœ¨javaçš„ä¸–ç•Œé‡Œï¼ŒThreadç±»æ˜¯å¯¹çº¿ç¨‹æ¦‚å¿µçš„æŠ½è±¡ã€‚æƒ³è¦ä¸­æ–­ä¸€ä¸ªçº¿ç¨‹æœ‰ä¸¤ç§æ–¹å¼ï¼š

- ï¼ˆ1ï¼‰è°ƒç”¨Threadç±»çš„stopæ–¹æ³•
- ï¼ˆ2ï¼‰ç»„åˆè°ƒç”¨Threadç±»çš„<code>interrupt</code>ã€<code>interrupted</code>å’Œ<code>isInterrupted</code>æ–¹æ³•

â€‹		é€šè¿‡æºç çš„æ³¨é‡Šæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè°ƒç”¨stop()å¯èƒ½ä¼šäº§ç”Ÿçº¿ç¨‹å¼‚å¸¸ï¼ŒæŠ›å‡º<code>SecurityException</code>å¼‚å¸¸ã€‚å…¶åŸå› ä¸ºä½¿ç”¨<code>stop</code>æ–¹æ³•è¿›è¡Œä¸­æ–­çº¿ç¨‹æœ¬è´¨ä¸Šæ˜¯ä¸å®‰å…¨çš„ï¼Œå®ƒä¼šç›´æ¥é‡Šæ”¾æ‰æœ¬çº¿ç¨‹æ‰€æŒæœ‰çš„æ‰€æœ‰èµ„æºï¼Œä¸¾ä¸ªç®€å•çš„æ —å­æ¥è¯´ï¼Œå‡å¦‚æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨æŸä¸ªçº¿ç¨‹ä¸‹è½½ç”µå½±ï¼Œå¦‚æœè¯¥çº¿ç¨‹æˆ–è€…å…¶ä»–çº¿ç¨‹é€šè¿‡è¯¥çº¿ç¨‹çš„stopè¿›è¡Œä¸­æ–­ï¼Œåˆ™åŸæ¥ä¸‹è½½çš„å†…å®¹å°†å…¨éƒ¨ä¸¢å¤±ã€‚

ç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“Javaçº¿ç¨‹çš„è®¾è®¡æ˜¯<code>åä½œå¼</code>çš„ï¼Œè€Œä¸æ˜¯<code>æŠ¢å å¼</code>çš„ï¼Œ

![image-20220121111922631](https://cdn.fengxianhub.top/resources-master/202201211119738.png)



### 2.1 interrupt()å®ç°ä¸­æ–­

interrupted()æ–¹æ³•æ˜¯å‘èµ·çº¿ç¨‹ä¸­æ–­è¯·æ±‚ï¼Œä½†åªæ˜¯è¯·æ±‚ï¼Œå¹¶ä¸ä¼šçœŸçš„æŠŠçº¿ç¨‹ç»™ä¸­æ–­ï¼Œå®é™…ä¸Šæ˜¯æŠŠçº¿ç¨‹çš„ä¸­æ–­æ ‡è¯†è®¾ç½®ä¸ºäº†true

```java
public static void main(String[] args) {
    //é€šè¿‡interrupted() æ–¹æ³•æ£€æµ‹çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­
    System.out.println(Thread.currentThread().getName()+"çº¿ç¨‹æ˜¯å¦ä¸­æ–­"+Thread.interrupted());
    //è®¾ç½®çº¿ç¨‹ä¸­æ–­
    Thread.currentThread().interrupt();
    //é€šè¿‡interrupted()æ–¹æ³•æ£€æµ‹çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œå¹¶ä¸”ä¼šæ¢å¤ä¸­æ–­
    System.out.println(Thread.currentThread().getName()+"çº¿ç¨‹æ˜¯å¦ä¸­æ–­"+Thread.interrupted());
}

è¾“å‡ºï¼š
    mainçº¿ç¨‹æ˜¯å¦ä¸­æ–­false
    mainçº¿ç¨‹æ˜¯å¦ä¸­æ–­true
```

### 2.2 isInterrupted()æ£€æŸ¥çº¿ç¨‹ä¸­æ–­

isInterrupted()æ–¹æ³•æ˜¯åˆ¤æ–­çº¿ç¨‹çš„ä¸­æ–­æ ‡è¯†æ˜¯å¦ä¸ºtrue

```java
public static void main(String[] args) {
    //å½“å‰çº¿ç¨‹
    Thread thread = Thread.currentThread();
    //æ£€æµ‹å½“å‰çº¿ç¨‹æ—¶å€™è¢«ä¸­æ–­
    System.out.println(thread.getName()+"çº¿ç¨‹æ˜¯å¦ä¸­æ–­"+thread.isInterrupted());
    //è®¾ç½®å½“å‰çº¿ç¨‹çš„ä¸­æ–­æ ‡è¯†
    thread.interrupt();
    //æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦ä¸­æ–­
    System.out.println(thread.getName()+"çº¿ç¨‹æ˜¯å¦ä¸­æ–­"+thread.isInterrupted());
    //æ£€æµ‹å½“å‰çº¿ç¨‹ä¸­æ–­çŠ¶æ€æ˜¯å¦è¢«æ¸…é™¤
    System.out.println(thread.getName()+"çº¿ç¨‹æ˜¯å¦ä¸­æ–­"+thread.isInterrupted());
    try {
        //çº¿ç¨‹ä¼‘çœ 2s
        //è¿™é‡Œè®¾ç½®çš„æ˜¯çº¿ç¨‹ä¼‘çœ 20sï¼Œä½†æ˜¯å› ä¸ºçº¿ç¨‹ä¸­æ–­ï¼Œæ‰€æœ‰sleepä¼šè¢«æ‰“æ–­
        Thread.sleep(20000);
        System.out.println(thread.getName()+"çº¿ç¨‹ä¼‘çœ æœªè¢«ä¸­æ–­...");
    } catch (Exception e) {
        System.out.println(thread.getName()+"çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­...");
        //åˆ¤æ–­çº¿ç¨‹æ˜¯éƒ½è¢«ä¸­æ–­
        System.out.println(thread.getName()+"çº¿ç¨‹æ˜¯å¦ä¸­æ–­"+thread.isInterrupted());
    }finally {
        System.out.println(thread.getName()+"çº¿ç¨‹æ˜¯å¦ä¸­æ–­"+thread.isInterrupted());
    }
}

è¾“å‡ºç»“æœï¼š
    mainçº¿ç¨‹æ˜¯å¦ä¸­æ–­false
    mainçº¿ç¨‹æ˜¯å¦ä¸­æ–­true
    mainçº¿ç¨‹æ˜¯å¦ä¸­æ–­true
    mainçº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­...sleep interrupted
    mainçº¿ç¨‹æ˜¯å¦ä¸­æ–­false
    mainçº¿ç¨‹æ˜¯å¦ä¸­æ–­false
```

â€‹		åœ¨è¿™ä¸ªæ —å­ä¸­æˆ‘ä»¬çœ‹åˆ°çº¿ç¨‹åœ¨è®¾ç½®<code>interrupt()</code>åï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå¹¶æ²¡æœ‰é©¬ä¸Šä¸­æ–­ï¼Œè¿™å…¶å®åªæ˜¯å‘èµ·çº¿ç¨‹ä¸­æ–­è¯·æ±‚ï¼Œå¹¶ä¸ä¼šçœŸçš„æŠŠçº¿ç¨‹ç»™ä¸­æ–­ï¼Œåªæ˜¯æŠŠçº¿ç¨‹çš„ä¸­æ–­æ ‡è¯†è®¾ç½®ä¸ºäº†trueã€‚CPUåœ¨æ‰§è¡Œçº¿ç¨‹æ—¶åˆæ²¡æœ‰é˜»å¡ä¹Ÿæ²¡æœ‰è½¬åˆ°å…¶ä»–è¯­å¥ï¼Œå½“ç„¶è¦å¾€ä¸‹æ‰§è¡Œï¼Œ<code>interrupt()</code>åªæ˜¯æŠ›å‡ºä¸€ä¸ªæ¶ˆæ¯ï¼Œâ€œè¦æ±‚â€è°ƒç”¨ä»–çš„è¿›ç¨‹ä¸­æ–­ï¼Œä»–åªæ˜¯è´Ÿè´£å‘å‡ºè¦æ±‚ï¼Œ<code>å…·ä½“æ‰§è¡Œç”±å…¶ä»–å‡½æ•°å®ç°</code>ã€‚æ‰€ä»¥è¿™ä¸ªè¯­å¥å‡ºç°è¿›ç¨‹ä¸ä¼šä¸­æ–­ã€‚

â€‹		 ğŸš©åœ¨çº¿ç¨‹æ‰§è¡Œåˆ°<code>Thread.sleep(20000)</code>æ—¶ï¼Œçº¿ç¨‹ç”±<code>è¿è¡Œæ€</code>è½¬æ¢ä¸º<code>é˜»å¡æ€</code>ï¼Œä½†æ˜¯å› ä¸ºè®¾ç½®äº†çº¿ç¨‹ä¸­æ–­ï¼Œæ‰€ä»¥<code>sleep()</code>ä¼šæ‰§è¡Œç»ˆç«¯ï¼Œçº¿ç¨‹ä¼šé€€å‡ºé˜»å¡æ€ç»§ç»­æ‰§è¡Œï¼Œç”±æ­¤å¯ä»¥æˆ‘ä»¬å¯ä»¥çŸ¥é“<code>interrupt()</code>æ˜¯ä¸­æ–­å¤„äº<code>é˜»å¡/ç¡çœ çŠ¶æ€çš„çº¿ç¨‹</code>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„ä¸­æ–­å¹¶ä¸æ˜¯è®©çº¿ç¨‹æ­»äº¡ï¼Œ è€Œæ˜¯é€€å‡ºé˜»å¡çŠ¶æ€ç»§ç»­è¿è¡Œï¼Œæ‰€ä»¥interruptä¸èƒ½ä¸­æ–­è¿è¡Œä¸­çš„çº¿ç¨‹ã€‚

jdké‡Œ<code>interrupt()</code>è§£é‡Šï¼š

![image-20220121120938507](https://cdn.fengxianhub.top/resources-master/202201211209690.png)

å½“ç„¶ Java ä¹Ÿæœ‰å¾ˆå¤šåº•å±‚å®ç°æ˜¯çœ‹ä¸åˆ°çš„ï¼š

![image-20220121122201266](https://cdn.fengxianhub.top/resources-master/202201211222363.png)

### 2.3 interruptedæ£€æµ‹çº¿ç¨‹ä¸­æ–­å¹¶æ¸…é™¤ä¸­æ–­

æ²¡æœ‰æ —å­ï¼Œå¯ä»¥çœ‹2.1çš„æ —å­



### 2.4 çº¿ç¨‹ä¸­æ–­å¼‚å¸¸å¤„ç†

åœ¨2.2ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå½“çº¿ç¨‹é˜»å¡çš„è°ƒç”¨ä¸€äº›æ–¹æ³•ä¼šå¯¼è‡´<code>InterruptedException</code>å¼‚å¸¸æŠ›å‡º

åœ¨æ•è·å¼‚å¸¸çš„æ—¶å€™æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å…¶è¿›è¡Œ<code>å¼‚å¸¸å¤„ç†</code>

- æŠ›å‡º <code>InterruptedException</code>
- æ•è·<code>InterruptedException</code>åé‡æ–°æŠ›å‡ºã€‚
- æ£€æµ‹åˆ°ä¸­æ–­åï¼Œé‡æ–°è®¾ç½®çº¿ç¨‹ä¸­æ–­. 

```java
//æ•è·InterruptedExceptionåé‡æ–°æŠ›å‡ºã€‚
public static void main(String[] args) throws InterruptedException {
    //å½“å‰çº¿ç¨‹
    Thread thread = Thread.currentThread();
    try {
        //è®¾ç½®å½“å‰çº¿ç¨‹çš„ä¸­æ–­æ ‡è¯†
        thread.interrupt();
        Thread.sleep(20000);
    } catch (InterruptedException e) {
        System.out.println(thread.getName()+"çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­..."+e.getMessage());
        //åˆ¤æ–­çº¿ç¨‹æ˜¯éƒ½è¢«ä¸­æ–­
        System.out.println(thread.getName()+"æ‰§è¡Œç»ˆç«¯å¤„ç†");
        throw e;
    }
è¾“å‡ºï¼š
    mainçº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­...sleep interrupted
    mainæ‰§è¡Œç»ˆç«¯å¤„ç†
    Exception in thread "main" java.lang.InterruptedException: sleep interrupted
        at java.lang.Thread.sleep(Native Method)
        at com.fx.multiThread._7_HandleInterruptedException.main(_7_HandleInterruptedException.java:15)
```

```java
//æ£€æµ‹åˆ°ä¸­æ–­åï¼Œé‡æ–°è®¾ç½®çº¿ç¨‹ä¸­æ–­. 
public class _8_ReInterrupted extends Thread{
    public static void main(String[] args) throws InterruptedException {
        //å½“å‰çº¿ç¨‹main
        String threadName = Thread.currentThread().getName();
        _8_ReInterrupted reInterrupted = new _8_ReInterrupted();
        System.out.println(printDate() + threadName + " çº¿ç¨‹å¯åŠ¨");
        //å¯åŠ¨æ–°çº¿ç¨‹
        reInterrupted.start();
        //ä¸»çº¿ç¨‹ä¼‘çœ 3ç§’
        Thread.sleep(3000);
        System.out.println(printDate() + threadName + " è®¾ç½®å­çº¿ç¨‹ä¸­æ–­");
        //å¯¹å­çº¿ç¨‹è®¾ç½®çº¿ç¨‹ä¸­æ–­  åœ¨ä¸»çº¿ç¨‹é‡Œé¢æ“ä½œå…¶ä»–çº¿ç¨‹
        reInterrupted.interrupt();
        //ä¸»çº¿ç¨‹ä¼‘çœ 3ç§’
        Thread.sleep(3000);
        System.out.println(printDate() + threadName + " è¿è¡Œç»“æŸ");
    }

    @Override
    public void run() {
        //å½“å‰çº¿ç¨‹
        String threadName = Thread.currentThread().getName();
        int i = 0;
        //å¾ªç¯ç­‰å¾…çº¿ç¨‹ä¸­æ–­
        while (!Thread.currentThread().isInterrupted()){//åªåˆ¤æ–­çŠ¶æ€ä¸æ¸…é™¤çŠ¶æ€
            System.out.println(printDate() + threadName + " çº¿ç¨‹æ­£åœ¨æ‰§è¡Œç¬¬ï¼š"+(++i)+"æ¬¡");
            try {
            	//çº¿ç¨‹é˜»å¡ï¼Œå¦‚æœçº¿ç¨‹æ”¶åˆ°ä¸­æ–­æ“ä½œå‹å·å°†æŠ›å‡ºå¼‚å¸¸
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                System.out.println(printDate() + threadName + " çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸");
                //æ£€æµ‹çº¿ç¨‹æ˜¯å¦ä¸­æ–­
                System.out.println(printDate() + threadName + " çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­" + this.isInterrupted());
                //TODO å¦‚æœä¸éœ€è¦åˆ™ä¸ç”¨è°ƒç”¨  å¦‚æœè°ƒç”¨Interrupt()æ–¹æ³•çš„è¯ï¼Œåˆ™å½“å‰çº¿ç¨‹çŠ¶æ€å˜ä¸ºä¸­æ–­ï¼Œå°†é€€å‡ºå¾ªç¯ï¼Œç¨‹åºç»“æŸ
                Thread.currentThread().interrupt();
            }
        }
        System.out.println(printDate() + threadName + " çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­" + this.isInterrupted());
        System.out.println(printDate() + threadName + " çº¿ç¨‹é€€å‡º");
    }
    //æ‰“å°å½“å‰äº‹ä»¶
    private static String printDate() {
        return new SimpleDateFormat("HH:mm:ss").format(System.currentTimeMillis())+"\t";
    }
}

```









